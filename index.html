<!doctype html>
<html lang="en" ng-app>
  <head>
    <title>Az</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
      <link rel="stylesheet" href="/css/fonts/8bit/stylesheet.css">
      <link rel="stylesheet" href="http://csshake.surge.sh/csshake.min.css">
      <script src="/webcomponentsjs/webcomponents.js"></script>
      <link href="story.html" rel="import">
      <link href="sfx.html" rel="import">
      <link href="controls.html" rel="import">
    <style>
      .pap {
        font-family: "Papyrus";
      }
      .sans {
        font-family: "Comic Sans MS";
      }
      .mon {
        font-family: "8bitoperator";
      }
      story-box {
        width: 90%;
        height: 95%;
      }
      #modal1, .modal-footer {
        background-color: #000000 !important;
        color: #ffffff !important;
      }
      #name {
        margin: auto;
      }
      .white {
        background-color: #ffffff;
        position: fixed;
        width: 100%;
        height: 100%;
        display: block;
        z-index: 5000000;
      }
      #namelabel {
        font-size: 18px;
      }
      .centered {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }
      .hint {
        text-decoration: underline dotted rgba(255, 255, 255, .2);
      }
    </style>
  </head>
  <body class="blue-grey darken-1">
    <div class="white"></div>
    <div class="navbar-fixed">
      <ul id="dropdown1" class="dropdown-content">
  <li><a href="javascript:chapter(1)">One</a></li>
  <li><a href="javascript:chapter(2)">Two</a></li>
  <li><a href="javascript:chapter(3)">Three</a></li>
  <li class="divider"></li>
  <li><a href="javascript:chapter(4)">Four</a></li>
  <li><a href="javascript:chapter(5)">Five</a></li>
  <li class="divider"></li>
  <li><a href="javascript:chapter(6)">Six</a></li>
  <li><a href="javascript:chapter(7)">Seven</a></li>
  <li class="divider"></li>
  <li><a href="javascript:chapter(8)">Afterword</a> </li>
</ul>
    <nav>
      <div class="nav-wrapper">
        <a href="#!" class="brand-logo"><span class="hide-on-med-and-down">&nbsp;&nbsp;&nbsp;</span>Az</a>
        <a class="dropdown-button right" href="#!" data-activates="dropdown1">Chapters<i class="material-icons right">arrow_drop_down</i></a>
      </div>
    </nav>
  </div>
  <input type="hidden" class="modal-trigger" data-target="modal1" href="modal1">
  <div id="modal1" class="modal" >
    <div class="modal-content">
      <form action="javascript:showS()">
        <label for="name" id='namelabel'><span class="mon">Name the fallen child.</span></label>
        <input id="name" type="text" class="validate">
      </form>
    </div>
    <div class="modal-footer">
      <a href="" class="modal-action waves-effect btn-flat mon" id="nameCanc" style="position: absolute !important; color: white; left: 7px;" onclick="canc()">No</a><a href="" id="nameConf" class="modal-action waves-effect btn-flat mon" style="color:white;" onclick="showS()">Done</a>
    </div>
  </div>
  
    <story-box chapters="8" id="story"></story-box>
    <audio-controls id="audio-controls"></audio-controls>
    <script src="/js/jquery.min.js"></script>
    <audio src="/music/Memory.mp3" id="music" loop></audio>
    <sfx-audio></sfx-audio>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
    <script src="/js/angular.min.js"></script>
    <script>
    var nam;
    var astate = document.querySelector("#audio-controls");
    console.log("Hello, fellow developers! Prepare for error hell! If someone would help me with some stuff, I would be grateful! I am talking about some weird Polymer element attribute stuff. If you can help, my information is in the Afterword or the last chapter.");
    var mute = false;
      function chapter(c){
        document.querySelector("#story").chapter = c;
      }
      function pa(action, options){
        if(!mute){
          if(action == "start"){
            document.querySelector("#music").src = "/music/" + options.name + ".mp3";
            document.querySelector("#music").play();
            astate.audio = options.name;
            astate.playing = 1;
          }
          if(action == "play"){
            document.querySelector("#music").play();
            astate.playing = 1;
          }
        }
        if(action == "stop"){
          document.querySelector("#music").src = "";
          astate.playing = 0;
            astate.audio = "";
        }
        if(action == "pause"){
          document.querySelector("#music").pause();
          astate.playing = 2;
        }
        if(action == "sfx"){
          document.querySelector("#" + options.name).play();
        }
      }
      function canc(){
        $("#nameCanc").hide();
        $("#nameConf").html("DONE").show();
        $(".modal-content").html('<form action="javascript:showS()"><label for="name"><span class="mon" id="namelabel">Name the fallen child.</label><input id="name" type="text" class="validate"></form>');
        $("#nameConf").off("click", st);
        namecnt = false;
      }
      var st = function(){
        document.querySelector("#story").name=nam;
        $("#nameConf").hide();
        $("#nameCanc").hide();
        $(".modal-content").html("<div class='shake-little shake-constant' style='width: 100%; text-align:center; padding:auto'><h1 class='mon centered' id='name'>" + nam + "</h1></div>");
        $(".white").fadeIn(5000, function(){
          $("#modal1").closeModal();
          window.setTimeout(function(){
            $(".white").fadeOut(40, function(){
              window.setTimeout(function(){
                pa("play");
              }, 1000)
            });
            window.scrollTo(0, 0);
          }, 600);
        })
      };
      var namecnt = false;
      function showS(){
        if(!namecnt){
        nam = $("#name").val();
        $("#nameConf").html("YES").on("click", st);
        $(".modal-content").html("<h5 class='mon' id='nameStatus' style='width:35%;'>Is this correct?</h5><div class='shake-little shake-constant' style='width: 100%; text-align:center; padding:auto'><h1 class='mon' id='name'>" + nam + "</h1></div>");
        $("#nameCanc").show();
        }
        namecnt = true;
        if(nam.toLowerCase() == "frisk"){
          $("#nameStatus").html("WARNING: This name will make your life hell (Especially in Part 4). Read anyway?");
        }if(nam.toLowerCase() == "chara"){
          $("#nameStatus").html("The true name.");
        }if(nam.toLowerCase() == "asriel"){
          $("#nameStatus").html("...");
          $("#nameConf").hide();
        }if(nam.toLowerCase() == "flowey"){
          $("#nameStatus").html("I already CHOSE that name.");
          $("#nameConf").hide();
        }if(nam.toLowerCase() == "sans"){
          $("#nameStatus").html("nope.");
          $("#nameConf").hide();
        }if(nam.toLowerCase() == "toriel"){
          $("#nameStatus").html("I think you should think of your own name, my child.");
          $("#nameConf").hide();
        }if(nam.toLowerCase() == "gaster"){
          $("#white").fadeIn(20, function(){
            location.reload();
          });
        }if(nam.toLowerCase() == "temmie"){
          $("#nameStatus").html("hOI!");
        }if(nam.toLowerCase() == "asgore"){
          $("#nameStatus").html("You cannot.");
          $("#nameConf").hide();
        }if(nam.toLowerCase() == "undyne"){
          $("#nameStatus").html("Get your OWN name!");
          $("#nameConf").hide();
        }if(nam.toLowerCase() == "alphys"){
          $("#nameStatus").html("D-don't do that!");
          $("#nameConf").hide();
        }if(nam.toLowerCase() == "shyren"){
          $("#nameStatus").html("...?");
        }if(nam.toLowerCase() == "aaron"){
          $("#nameStatus").html("Is this name correct? ;)");
        }if(nam.toLowerCase() == "mercy"){
          $("#nameStatus").html("That's a little on-the-nose, isn't it..?");
        }if(nam.toLowerCase() == "gerson"){
          $("#nameStatus").html("Wah ha ha! Why not?");
        }if(nam.toLowerCase() == "napsta" || nam.toLowerCase() == "napstablook" || nam.toLowerCase() == "blooky"){
          $("#nameStatus").html(".................<br>(They're powerless to stop you)");
        }
      }
      $( document ).ready(function(){
        $(".dropdown-button").dropdown();
        
         $('.modal-trigger').leanModal({
      dismissible: false, // Modal can be dismissed by clicking outside of the modal
      opacity: 1, // Opacity of modal background
      in_duration: 300, // Transition in duration
      out_duration: 200, // Transition out duration
    }
  );
  $("#modal1").openModal({
    dismissible: false, // Modal can be dismissed by clicking outside of the modal
      opacity: 1, // Opacity of modal background
      in_duration: 100, // Transition in duration
      out_duration: 100, // Transition out duration
  });
  $("#nameCanc").hide();
  $(".white").hide();
      });
      
      var chS = [
        {
          forease: "of use",
        },
        {
          woot: "nuttin' here now"
        },
        {
          fire: function(){
            $("#music").animate({volume: 0}, 2000);
          }
        },
        {
          fire1: function(){
            $(".nxt").on("click", chS[3].clik);
            $("#music").animate({volume: .2}, 800);
            window.setTimeout(function(){
              pa("start", {name: "Don't Give Up"});
              $("#music").animate({volume: 1.0}, 800);
            }, 800);
          },
          clik: function(){
            pa("sfx", {name: "sf01"});
            $("#music").animate({volume: .0}, 800);
            $(".nxt").off("click", chS[3].clik);
          }
        },
        {
          fire: function(){
            $("#music").animate({volume: .0}, 4000);
            window.setTimeout(function(){
              $("#music").animate({volume: 1.0}, 5);
              pa("start", {name: "His Theme"});
            }, 4100);
          },
          done: false,
        }
      ];
      
      document.addEventListener('select', function() {
        
      }, false);
      
    </script>
      <script src="/js/smoothscroll.js"></script>
  </body>
</html>